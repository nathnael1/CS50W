{% extends "network/layout.html" %}
{% load static %}
{% block body %}
    <h1>
        Following Posts
    </h1>
    <form id="createpost" method = "post" action = "{% url 'publish' %}">
        {% csrf_token %}
        <input type="text" name = "content">
        <input type="submit"  value="POST">
    </form>

    {% for publish in published %}
        <div class="published">
            <a href="#" class = "postuser">{{publish.user}}</a>
            <p class = "content">{{publish.content}}</p>
            <p class = "time">{{publish.time}}</p>
            <p class ="like">Likes{{publish.likes}}</p>
        </div>
        {%empty%}
        <h1>No posts</h1>
    {% endfor %}

<script>
        const itemsPerPage = 10;
    const publishedItems = document.querySelectorAll('.published')
    function displayItems(page)
    {
        const startIndex = (page -1) * itemsPerPage
        const endIndex = startIndex + itemsPerPage
        for (let i =startIndex; i < endIndex && i < publishedItems.length; i++)
        {
            publishedItems[i].style.display = 'block'
        }
    }
    function createPagination(){
        
        const pageCount = Math.ceil(publishedItems.length/itemsPerPage)
        const paginationContainer = document.createElement('div')
        document.querySelector('body').append(paginationContainer)

        for(let i = 1; i <= pageCount; i++)
        {
            const pageButton = document.createElement('button')
            pageButton.textContent = i;
            pageButton.addEventListener('click',()=> displayItems(i))
            paginationContainer.append(pageButton)
            
        }
    }
    displayItems(1);
    createPagination()
</script>

{% endblock %}

